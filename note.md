# 6.5 프락시 요청의 미묘한 특징들

### 6.5.1 프락시 URL 는 서버 URL 와 다르다
<details>
    <summary>내용</summary>

#### 클라 ->  서버 직접 요청
* ![img_6.png](img_6.png)
* URL 부분에 주목! -> '/index.html' 과 같이 부분 URL 만 표시
#### 클라 -> 프락시 -> 서버 요청
* ![img_7.png](img_7.png)
* 프락시로 요청을 보낼 때, 완전한 URL 을 보냄

#### 왜 원 서버로 보낼 때와 프락시로 보낼 때 URL 이 다를까? -> HTTP 역사와 디펜던시가 있는 부분
* 과거 상황
    * 원래의 HTTP 설계에서, 클라는 단일한 서버와 통신하는 것이 전재되어 있었다.
        * 가상 호스팅, 프락시에 대한 대비가 없었다.
    * 단일 서버와 통신을 가정한다면, 해당 서버의 호스트 명과 포트번호는 불필요한 정보였다.
        * 따라서 보내지 않았던 것이다.
* 현 상황
    * 프락시, 가상호스팅 등이 부상했다.
    * 이에 따라 부분 URL 만 보내는 것이 문제가 되었다.
        * ex> [클라 <-> 프락시 <-> 원 서버] 상황에서 [클라 -> 프락시]로 부분 URL 만 보내면 프락시 입장에선 어느 서버로 요청을 전달할 지 알 수 없었다.
* HTTP 1.0 에서의 해결책
    * 프락시 요청의 경우 완전한 URL 을 요구하는 것으로 문제를 해결???
        * 해결이라기 보단 프락시가 부상하면서 급한 불을 끈 느낌
* HTTP 1.1 에서의 해결책
    * 프락시건 뭐건 클라는 완전한 URL 을 다룰 것을 요구
    * but HTTP 1.0 시절의 스팩으로 이미 배치된 서버가 너무 많고 이 서버들은 완전한 URL 을 받아들이지 못하는 경우가 많다ㅠㅠ

#### 따라서 일반적으로 서버로는 부분 URL 을, 프락시로는 완전한 URL 을 보낼 필요가 있다.
* 우리는 HTTP 클라이언트를 사용하고 있고 이 클라이언트에게 프락시를 쓸지 말지 설정을 할 수 있다.
* HTTP 클라이언트는 프록시 사용 설정에 따라 똑똑하게 아래와 같이 동작한다.
    * 클라가 프록시를 사용하도록 설정된 경우 -> 완전한 URL 을 보낸다
    * 클라가 프록시를 사용하지 않도록 설정된 경우 -> 부분 URL 을 보낸다

#### Q) 리버스 프락시를 사용할 경우는 어떻게 될까?
* 리버스 프락시는 클라가 프록시를 사용하는지 조차 모르는 것이 특징이다.
* 따라서 클라 입장에선 명시적인 프락시 설정이 포함되지 않을 것이고
* 따라서 부분 URL 을 보낼 것 같다.
    * 즉, 리버스 프락시 구현 서버들은 부분 URL 에 대해 대비가 되어 있어야 할 것이다.
</details>



